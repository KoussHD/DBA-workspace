*******************************************************************
SQL Loader - Combine multiple lines from a datafile and load as one
*******************************************************************
Example:

Consider the data in the following record.

122|SAP|SAP ABAP|Programmer Analyst|
123|Oracle|Oracle Applications
E Business Suite|Software
Engineer|
124|Microsoft|Microsoft Business Intelligence|Systems Analyst|
 

LOAD DATA
CONTINUEIF LAST <> '|'
INTO TABLE TABLE_NAME
FIELDS TERMINATED BY "|"
TRAILING NULLCOLS



Result:

In our case, the data is considered as:

122|SAP|SAP ABAP|Programmer Analyst|
123|Oracle|Oracle Applications E Business Suite|Software Engineer|----------------concatenated line
124|Microsoft|Microsoft Business Intelligence|Systems Analyst|


“Here the keyword LAST says that, if the record in the datafile doesnt endup with a '|' symbol, then append the corresponding line to the current line. If the subsequent line also doesnt end with a '|' then add the next line into current line. This goes on until the row which has '|' as a last character in the line.”

Parameters with CONTINUEIF
1)THIS:    If the condition is satisfied in the current line, then the next line is appended to the current line until the condition becomes, false.
2)NEXT:If the condition is satisfiled in the next line, then that line is appended to the current line until the conditions becomes false.
3)operator: Operators allowed here are equal to and not equal to.
4)LAST:  If the condition satisfies with the last non-blank character in the line, then the next line is appended with the line until condition becomes false.
5)position: Checking the data between specified positions in the data file record. It starts with start position, then a hyphen or colon and then the end position. Ex: 1:5 indicates characters from 1 to 5.
 
Example with THIS keyword:
--------------------------
 CONTINUEIF THIS (1:2) = 'tt'
Then the records
tt_age
tt_birthdate
t_year
tt_name
tt_salary
t_exp
 
is considered as
_age_birthdatet_year
_name_salaryt_exp
 
You might have considered here that, the comparing character 't' is missing in the result avoiding unnessary joining characters. If you want to retain 
the comparison character in the result then, use PRESERVE keyword.
 
 CONTINUEIF PRESERVE THIS (1:2) = 'tt'

is considered as
tt_agett_birthdatet_year
tt_namett_salaryt_exp
 
This will be same for NEXT keyword but in reverse.
 
Example for LAST keyword:
CONTINUEIF LAST != '.'
 
If each record ends with a dot(.) and the data is like
 
Albert,Programmer,Oracle.
Scott,
Developer,
Oracle.
Robert,Consultant,Oracle.
The LAST keyword checks for the availability of the dot(.) as the last non-blank character and appends accordingly. So the lines 2,3,4 are considered as
Scott,Developer,Oracle.
The LAST keyword doesnt eliminate the condition string or character from the result. So no need to use the PRESERVE keyword in this case.