select segment_name,keep (dense_rank last order by sum_size)
from (
        select segment_name,sum(bytes)/1024/1024 as sum_size 
        from dba_segments where segment_name in (select table_name from dba_tables where owner='STO_MDPIDS1')
        group by segment_name   
    )
    ;
    
    
    
select segment_name,sum(bytes)/1024/1024 as MB from dba_segments 
where segment_name in (select table_name from dba_tables where owner='STO_MDPIDS1') 
group by segment_name having MB=max();



select * from
(
select a.*,rank() over (order by sum_sales desc) r from
(select pub_id,sum(sales*price) sum_sales from titles group by pub_id) a
)
where r = 1;    



select segment_name,sum_size "max_size" from
(select s.*,rank() over (order by sum_size desc) r from
(select segment_name,sum(bytes)/1024/1024 as sum_size from dba_segments where segment_name in (select table_name from dba_tables where owner='STO_MDPIDS1') 
group by segment_name) s
)
 where r=1;
  