shortcut
%SystemRoot%\system32\cmd.exe /k pushd "D:\oracle\product\10.2.0\db_1\BIN"

Shutdown -s -t 0 | shutdown -r -t 0 (Core server or server 2008)
shutdown /s /t 0 |shutdown /r /t 0 (server 2012)

share folder 
net share Sharename=C:\Users\Myname
ShareName : The network name of the shared folder.
 net share SQL-Core=C:\backup

= %Variable:~X,Y%: get a substring of a string of an environment variable from position X in string with Y characters length.
set fileName=db_%date:~-4,4%%date:~-10,2%%date:~-7,2%_%time:~0,2%%time:~3,2%%time:~6,2%.bak
defines a variable with name fileName

starting with fixed string db_,
appending with %date:~-4,4% the last 4 characters of the current locale date which is obviously the year,YYYY
appending with %date:~-10,2% the tenth and ninth characters from right side of the current locale date which is most likely the month,MM
appending with %date:~-7,2% the seventh and sixth characters from right side of the current locale date which is most likely the day,DD
appending an underscore as separator between date in format YYYYMMDD and time in format HHmm,
appending with %time:~0,2% the first 2 characters of the current locale time which is obviously the hour,HH
appending with  %time:~3,2% the fourth and fifth character of the current locale time which is obviously the minute ,Min
appending with% %time:~6,2% the seventh and eighth caractere of the current local time which is the seconds,SS 
appending the file extension .bak.


schdule remote task:
at \\computername time /interactive | /every:date,... /next:date,... command

The following list describes the parameters that you can use with the at command:
 
\\computername: Use this parameter to specify a remote computer. If you omit this parameter, tasks are scheduled to run on the local computer.
time: Use this parameter to specify the time when the task is to run. Time is specified as hours:minutes based on the 24-hour clock. For example, 0:00 represents midnight and 20:30 represents 8:30 P.M.
/interactive: Use this parameter to allow the task to interact with the desktop of the user who is logged on at the time the task runs.
/every:date,...: Use this parameter to schedule the task to run on the specified day or days of the week or month, for example, every Friday or the eighth day of every month. Specify date as one or more days of the week (use the following abbreviations: M,T,W,Th,F,S,Su) or one or more days of the month (use the numbers 1 through 31). Make sure that you use commas to separate multiple date entries. If you omit this parameter, the task is scheduled to run on the current day.
/next:date,...: Use this parameter to schedule the task to run on the next occurrence of the day (for example, next Monday). Specify date as one or more days of the week (use the following abbreviations: M,T,W,Th,F,S,Su) or one or more days of the month (use the numbers 1 through 31). Make sure that you use commas to separate multiple date entries. If you omit this parameter, the task is scheduled to run on the current day.
command: Use this parameter to specify the Windows 2000 command, the program (.exe or .com file), or the batch program (.bat or .cmd file) that you want to run. If the command requires a path as an argument, use the absolute path name (the entire path beginning with the drive letter). If the command is on a remote computer, use the Uniform Naming Convention (UNC) path name (\\ServerName\ShareName). If the command is not an executable (.exe) file, you must precede the command with cmd /c, for example, cmd /c copy C:\*.* C:\temp.
id: Use this parameter to specify the identification number that is assigned to a scheduled task.
/delete: Use this parameter to cancel a scheduled task. If you omit the id parameter, all scheduled tasks on the computer are canceled.
/yes: Use this parameter to force a yes answer to all queries from the system when you cancel scheduled tasks. If you omit this parameter, you are prompted to confirm the cancellation of a task.

Oracle administration assistant for windows 
===========================================
Oracle perf counters for windows 
D:\> ORACLE_HOME\bin\operfcfg.exe
Enter user-name: system
Enter password: password
Enter tns-alias: orcl
operfcfg: New registry values have been successfully set.
If you run the following command, then operfcfg.exe does not prompt for a password:

operfcfg.exe -U user_name -D tns_alias
The -U and -D commands are optional.

The following examples illustrate use of operfcfg. First, to change user name to dba_admin and leave database name at its current value, you would enter:

C:\> operfcfg -U dba_admin
To change user name to dba_admin and database name to prod, you would enter:

C:\> operfcfg -U dba_admin -D prod
In the final example, you change host name to a blank value, causing Oracle Counters for Windows Performance Monitor to connect to the default database on the computer. 
The current user name and password must be valid user accounts on this database. 
Enter:
C:\> operfcfg -D 

===GUI
From the Start menu, select Programs, then select Oracle - HOME_NAME, then select Configuration and Migration Tools, and then select Administration Assistant for Windows.

Oracle Administration Assistant for Windows starts.

Right-click Performance Monitor.

Click Properties.

The Performance Monitor Properties dialog appears.

Modify the text in the Username, Password, or Database fields.

Click Apply.

==================================
Troubleshooting ORA-1031 or ORA-1017 Errors When Connecting As SYSDBA (Doc ID 730067.1)
A) File %ORACLE_HOME%/network/admin/sqlnet.ora
B) The output of the commands  "echo %username% and  "NET LOCALGROUP ORA_DBA"
C) A pair of client/server SQL*Net traces obtained while reproducing the problem as per Note 395525.1 and Note 374116.1.
=====================================
Before using an Oracle command line tool you need to MANUALLY SET the NLS_LANG parameter. In an MS-DOS command prompt, use the set command, for example:
C:\>chcp
Active code page: 850


MS-DOS codepage  Oracle Client character set (3rd part of NLS_LANG)
---------------- ------------------------------------------------
437                 US8PC437
                    
737                 EL8PC737
                    
850                 WE8PC850
                    
852                 EE8PC852
                    
857                 TR8PC857
                    
858                 WE8PC858
                    
861                 IS8PC861
                    
862                 IW8PC1507
                    
865                 N8PC865
                    
866                 RU8PC866

Operating System Locale   Oracle Client character set (3rd part of NLS_LANG)
------------------------ --------------------------------------------------
Dutch                       WE8PC850
English (United Kingdom)    WE8PC850
English (United States)     US8PC437
French                      WE8PC850
German                      WE8PC850

C:\> set NLS_LANG=FRENCH_CANADA.WE8PC850
 set NLS_LANG=american_america.AL16UTF16
 NLS_DATABASE_PARAMETERS
PARAMETER                VALUE                               
--------------------- --------------------------------------------
NLS_RDBMS_VERSION        12.1.0.2.0                          
NLS_NCHAR_CONV_EXCP      FALSE                               
NLS_LENGTH_SEMANTICS     BYTE                                
NLS_COMP                 BINARY                              
NLS_DUAL_CURRENCY        $                                   
NLS_TIMESTAMP_TZ_FORM    DD-MON-RR HH.MI.SSXFF AM TZR        
NLS_TIME_TZ_FORMAT       HH.MI.SSXFF AM TZR                  
NLS_TIMESTAMP_FORMAT     DD-MON-RR HH.MI.SSXFF AM            
NLS_TIME_FORMAT          HH.MI.SSXFF AM                      
NLS_SORT                 BINARY                              
NLS_DATE_LANGUAGE        AMERICAN     --                       
NLS_DATE_FORMAT          DD-MON-RR                           
NLS_CALENDAR             GREGORIAN      --                     
NLS_NUMERIC_CHARACTER    .,                                  
NLS_NCHAR_CHARACTERSE    AL16UTF16                           
NLS_CHARACTERSET         WE8MSWIN1252     --                   
NLS_ISO_CURRENCY         AMERICA                             
NLS_CURRENCY             $                                   
NLS_TERRITORY            AMERICA                             
NLS_LANGUAGE             AMERICAN                            
19 rows selected.     


A cluster is a group of hosts. When a host is added to a cluster, the host's resources become part of the cluster's resources. 
The cluster manages the resources of all hosts within it. 
Clusters enable the vSphere High Availability (HA) and vSphere Distributed Resource Scheduler (DRS) solutions.
 ESXi is the virtualization platform on which you create and run virtual machines. 
 vCenter Server is a service that acts as a central administrator for ESXi hosts that are connected on a network.
 vCenter Server allows you to pool and manage the resources of multiple hosts. 
 vCenter Server provides many features that allow you to monitor and manage your physical and virtual infrastructure.


CygWin package Quick start
============================
apt-cyg is a simple script. To install:
lynx -source rawgit.com/transcode-open/apt-cyg/master/apt-cyg > apt-cyg
install apt-cyg /bin


Example use of apt-cyg:
=====================sqlplus 
apt-cyg install rlwrap

RLWRAP function with sqlplus powershell
===============================
shopt -s checkwinsize
Now it’s simply a matter of creating a few aliases and a function that is similar to the Unix/Linux version. PowerShell aliases are managed using these commands:
# set-alias rw "C:\cygwin64\bin\rlwrap.exe"
 execute "sqltestdb" to start SQL*Plus using the rlwrap capabilities. Using this modular approach allows you to have a separate function for each database.
# function sqlMCR2 {rw -irc -f '/cygdrive/c/DBA WorkSpace/scripts/tpt/setup/wordfile_11gR2.txt' sqlplus kh85124@mcrorat02}  
set-alias your alias sqlMCR2
############for cygwin linux equivalent :alias rw=rlwrap
alias  sqlMCR2='rw -D2 -irc -b'\''"@(){}[],+=&^%#;|\'\'' -f '\''/cygdrive/c/DBA WorkSpace/scripts/tpt/setup/wordfile_11gR2.txt'\'' sqlplus kh85124@mcrorat02'
alias sqlmtldb='rw -D2 -irc -b'\''"@(){}[],+=&^%#;|\'\'' -f '\''/cygdrive/c/Users/kh85124/Documents/scripts/tpt/setup/wordfile_11gR2.txt'\'' sqlplus kh85124@montreal'    
If you want to get rid of it:
remove-item function:sqltestdb:
To list the function definitions use this command:
get-content function:\FUNCTION NAME (You can replace FUNCTION NAME with * to list all functions).

reverse research : Ctl+R

CHECK OS BLOCK SIZE ON WINDOWS  
============================
E:\>fsutil fsinfo ntfsinfo d:
NTFS Volume Serial Number :                           
Version :                                                                             
Bytes Per Sector  :               512
Bytes Per Physical Sector :       <Not Supported> 
Bytes Per Cluster :               4096      -------- 4K /64K etc..
Bytes Per FileRecord Segment    : 1024
Clusters Per FileRecord Segment :  





Boot time:
PShell C:\> wmic OS get LastBootupTime
c:> systeminfo

x add user 
------------
S C:\Users\Administrator> net user oracle1 Racattack1 /add /Medisolution
The command completed successfully.
Allow changing password : net user oracle password /ADD /PASSWORDCHG:Yes
Change password: 
PS C:\Users\Administrator> net user oracle *
Type a password for the user:
Retype the password to confirm:
The command completed successfully.

Kill remote desk session :
----------------------------

H:\>query session /server:TCRSVR0147
  SESSION           UTILISATEUR              ID  ÉTAT    TYPE        PÉRIPHÉRIQUE
 rdp-tcp#5         medisol1                  2  Actif   rdpwd
 
 H:\> reset session 2 /server:TCRSVR0147
 
secpol.msc > In the left pane, double-click Account Policies, and then click Password Policy.
Double-click the item in the Policy list (Account/pasword policy/ password meet complexity) to change, change the setting, and then click OK.

PS F:\Grid12102\grid> qwinsta
 SESSIONNAME       USERNAME                 ID  STATE   TYPE        DEVICE
 services                                    0  Disc
 console                                     1  Conn
>rdp-tcp#3         kh85124                   2  Active
 rdp-tcp                                 65536  Listen
 
 
 PowerShell Creating and Modifying Environment Variables
 -------------------------------------------------------
 "Get-ChildItem Env:"   Set equivalent
  Name                           Value
  ----                           -----
  Path                           D:\Perl\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Program Files\...
  TEMP                           C:\DOCUME~1\kmyer\LOCALS~1\Temp
  SESSIONNAME                    Console
  PATHEXT                        .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.PS1;.PSC1
  USERDOMAIN                     WINGROUP
  PROCESSOR_ARCHITECTURE         x86
  SystemDrive                    C:
  APPDATA                        C:\Documents and Settings\kmyer\Application Data
  windir                         C:\WINDOWS
  USERPROFILE                    C:\Documents and Settings\kmyer

1- check variable
---------------- 
$env:ORACL_HOME

2- Set variable
--------------
$env:TestVariable = "This is a test environment variable."
[Environment]::SetEnvironmentVariable("Oracle_home", "D/APP/ORACLE/product/12.1.0.2/db_1", "User")
[Environment]::SetEnvironmentVariable("TestVariable",$null,"User")
[Environment]::GetEnvironmentVariable("TestVariable","User")
3-Remove variable 
------------------
Remove-Item Env:\TestVariable


Insufficient privilege : 01031
------------------------------
I after granting user oracle2 privilages again (dba,oinstall) and editing SQLNET.ora file i just rebooted by system ./sqlplus /nolog conn sys/password as sysdba startup   it worked.

# show runing services 
-----------------------
> net start
Windows Connect Now - Registre de configuration
   Windows Driver Foundation - Infrastructure de pilote mode-utilisateur
   Windows Live ID Sign-in Assistant
   Windows Search
   Windows Update

# list all processes on the command line in Windows?
----------------------------------------------------
tasklist
If you have Powershell:
get-process
Via WMI:
wmic process

###windows Grep
C:\> dir /B | findstr /R /C:"[mp]"


1- list user group members :
------------------------

C:\Users> net localgroup "Utilisateurs"
Nom alias       Utilisateurs
Commentaire     Les membres du groupe Utilisateurs ne peuvent pas effectuer de modifications système accidentelles ou intentionnelles.Ainsi, les utilisateurs peuvent exécuter les applications certifiées,mais pas la plupart des applications héritées.

Membres
-------------------------------------------------------------------------------
12CSSSRT\Utilisa. du domaine
Admin_mts
ASPNET
AUTORITE NT\INTERACTIF
AUTORITE NT\Utilisateurs authentifiés
Medisolution
temporaire


C:\Users> NET LOCALGROUP ORA_DBA
Alias name     ORA_DBA
Comment        Oracle DBA Group

Members
------------------------------------- 
MEDISOLUTION\ChambePa
MEDISOLUTION\kh85124
NT AUTHORITY\SYSTEM
The command completed successfully.

D:\oracle\product\10.2.0\db_1\NETWORK\ADMIN>set oracle_sid=MCRORAT0
D:\oracle\product\10.2.0\db_1\NETWORK\ADMIN>NET LOCALGROUP ORA_%ORACLE_SID%_DBA
Alias name ORA_d1v10204_DBA
Comment Members can connect to instance d1v10204 as a DBA without a password

Members
--------------------------------------- 
dbadmin
The command completed successfully.

2- authorisation sur dossier :
---------------------------
 PS C:\> cacls D:\oracle
D:\oracle BUILTIN\Administrateurs:(OI)(CI)F
          AUTORITE NT\SYSTEM:(OI)(CI)F
          BUILTIN\Administrateurs:F
          CREATEUR PROPRIETAIRE:(OI)(CI)(IO)F
          BUILTIN\Utilisateurs:(OI)(CI)R 
          BUILTIN\Utilisateurs:(CI)(accès spécial :)FILE_APPEND_DATA
          BUILTIN\Utilisateurs:(CI)(accès spécial :)FILE_WRITE_DATA
3- show user
------------
          
C:\Users\kh85124>echo %username%
kh85124

   
   trusted IE certificat : certmgr.msc and then export non trusted to a file and copy it to trusted zone   
      
====================================================================================================================
 
  Enable running unsigned scripts by entering:
   PS C:\ set-executionpolicy remotesigned
  
  
  SCHEDULER
  ---------
  PS C:\Windows\system32> schtasks /Query /?

SCHTASKS /Query [/S system [/U username [/P [password]]]]
         [/FO format | /XML [xml_type]] [/NH] [/V]
         [/TN taskname] [/HRESULT] [/?]
Parameter List:
    /S    system         Specifies the remote system to connect to.
    /U    username       Specifies the user context under which schtasks.exe should execute.
    /P    [password]     Specifies the password for the given user context. Prompts for input if omitted.                       
    /FO   format         Specifies the format for the output.Valid values: TABLE, LIST, CSV.
    /NH                  Specifies that the column header should not be displayed in the output. This is valid only for TABLE and CSV format.
    /V                   Displays verbose task output.
    /TN   taskname       Specifies the task name for which to retrieve the information, else all of them.
    /XML  [xml_type]     Displays task definitions in XML format.
                         If xml_type is ONE then the output will be one valid X
                         If xml_type is not present then the output will be the concatenation of all XML task definitions.
                         
    /HRESULT             For better diagnosability, the process exit code will be in the HRESULT format.
    /?                   Displays this help message.

Examples:
    SCHTASKS /Query /S system /U user /P password
    SCHTASKS /Query /FO LIST /V /S system /U user /P password
    SCHTASKS /Query /FO TABLE /NH /V
- To export a task by using a command line
------------------------------------------
    schtasks /Query [/S <system> [/U <username> [/P [<password>]]]] /XML /TN <taskname>
    schtasks /Query /XML /TN monitor_alertlog 
    schtasks /Query /XML /TN monitor_serverspace
    schtasks /Query /XML /TN monitor_service
    schtasks /Query /XML /TN monitor_tablespace
    schtasks /Query /XML /TN monitor_verif_mensuel
    
    schtasks /query /S 10.84.101.61 /U medisolution /P Medi1idem /XML /TN  > monitor_alertlog.xml
The XML for the task is shown in the command prompt. Copy the XML for the task and paste it into a blank XML file. When the XML file is saved, the file will contain the task definition and can be imported.

=========
.EXAMPLE    
    .\Get-ScheduledTask.ps1 -Computername 10.84.101.61 ch12chra00061
    
    Get-ScheduledTask.ps1 -Subfolders -Hidden | Where-Object { $_.State -ne "Disabled" }
    .\Get-ScheduledTask.ps1 | Where-Object {$_.Name -eq 'TaskName')
Description  
-----------      
This command query mycomputer1 and display a formatted list of all scheduled tasks on that computer 


OR
1- copy c:\windows\system32\Schtasks.exe and Schedsvc.dll and put then in c:sch
2- copy the jobs into the 2008 server tasks location  c:\windows\system32\tasks
 
 schtasks /change /TN monitor_alertlog /RU kh85124 /RP password              OR  FOR /R . %F in (*.*) do schtasks /change /TN “%~nF” /RU <<Username>> /RP <<Password>>      


- Move to a subfolder : create a new folder through the GUI 
 FOR /R . %F in (*.job) do schtasks /Query /TN “%~nF” /XML > “C:temp%~nF.xml”
 - delete the jobs in the original folder
 -recreate the job files and put the tasks into the folder
 FOR /R c:temp %F in (*.xml) do schtasks /Create /S <<server name>> /RU <<username>> /RP <<password>> /XML “c:temp%~nF.xml” /TN “<<Task Scheduler folder destination name>>%~nF”



      ================DISKPART===========================
      ===(delete partition)

DISKPART> select disk 0 
DISKPART> select partition x 
DISKPART> delete partition 

PS C:\Users\Administrator> diskpart
DISKPART> list disk
Disk ###  Status         Size     Free     Dyn  Gpt
--------  -------------  -------  -------  ---  ---
Disk 0    Online           80 GB      0 B
Disk 1    Online           40 GB  1024 KB
Disk 2    Online         5120 MB  1024 KB


DISKPART> list volume
Volume ###  Ltr Label      Fs     Type      Size    Status    Info
----------  ---  -----------  -----  ----------  -------  ---------  ------
Volume 0     D                       DVD-ROM         0 B  No Media
Volume 1         System Rese  NTFS   Partition    350 MB  Healthy    System
Volume 2     C   OS           NTFS   Partition     79 GB  Healthy    Boot
Volume 3     E   DATA         NTFS   Partition     39 GB  Healthy
Volume 4     F   REDO         NTFS   Partition   5117 MB  Healthy

DISKPART> select volume 2
DISKPART> shrink minimum=36864+20 =36880
DISKPART> list disk 
Disk ###  Status         Size     Free     Dyn  Gpt
--------  -------------  -------  -------  ---  ---
Disk 0    Online           80 GB    36 GB
Disk 1    Online           40 GB  1024 KB
Disk 2    Online         5120 MB  1024 KB
DISKPART> select disk 0
DISKPART> create partition extended (1st)
DISKPART> create partition logical size=15360  
DISKPART> create partition logical size=10240 
DISKPART> create partition logical (10gb)
DISKPART> select disk 1
DISKPART> create partition extended (1st)
DISKPART> create partition logical size=10240
DISKPART> create partition logical size=15360  
DISKPART> create partition logical (15GB) 
DISKPART> select disk 1
DISKPART> create partition extended (1st)
DISKPART> create partition logical size=1024
DISKPART> create partition logical size=1024
DISKPART> list volume
                                   